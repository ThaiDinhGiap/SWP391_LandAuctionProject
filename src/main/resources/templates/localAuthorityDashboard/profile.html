<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <link rel="apple-touch-icon" sizes="76x76" th:href="@{/dashboardStatic/img/apple-icon.png}">
    <link rel="icon" type="image/png" th:href="@{/dashboardStatic/img/favicon.png}">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>
        Dashboard
    </title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
          name='viewport'/>
    <!--     Fonts and icons     -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet"/>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <!-- CSS Files -->
    <!-- CHI SUA CAC DUONG DAN CSS O DUOI DAY -->
    <link th:href="@{/dashboardStatic/css/bootstrap.min.css}" rel="stylesheet"/>
    <link th:href="@{/dashboardStatic/css/paper-dashboard.css?v=2.0.1}" rel="stylesheet"/>
    <!-- CSS Just for demo purpose, don't include it in your project -->
    <link th:href="@{/dashboardStatic/demo/demo.css}" rel="stylesheet"/>
</head>
<!---------------------------------------THÔNG TIN VỀ DASHBOARD------------------------------------------------------>
<!--
 - Phan dashboardStatic khong duoc sua
 - Phan dashboardTemplates moi nguoi cop ra rieng cho tung role, de y sua cac the th: cho phu hop, co gi thac mac cu hoi Bui Minh Chien
-->
<!--------------------------------------------------------------------------------------------->
<body class="">
<div class="wrapper ">
    <!--  Side navbar: chua lien ket den cac trang tuy chon cua minh  -->
    <div class="sidebar" data-color="white" data-active-color="danger">
        <div class="logo">
            <!--     Đường dẫn đến web chính của dự án     -->
            <a th:href="@{https://www.creative-tim.com}" class="simple-text logo-mini">
                <!--     Avatar người dùng ở đây     -->
                <div class="logo-image-small">
                    <img th:src="@{/dashboardStatic/img/logo-small.png}">
                </div>
                <!-- <p>CT</p> -->
            </a>
            <!--     Đường dẫn đến web chính của dự án     -->
            <a th:href="@{https://www.creative-tim.com}" class="simple-text logo-normal">
                Bui Minh Chien
                <!--     Thêm logo dự án ở đây     -->
                <!--           <div class="logo-image-big">-->
                <!--            <img src="../assets/img/logo-big.png">-->
                <!--          </div>-->
            </a>
        </div>
        <div class="sidebar-wrapper">
            <ul class="nav">
                <li>
                    <a th:href="@{/local-profile}">
                        <i class="nc-icon nc-single-02"></i>
                        <p>User Profile</p>
                    </a>
                </li>
                <li>
                    <a th:href="@{/LocalAuthority}">
                        <i class="nc-icon nc-tile-56"></i>
                        <p>Dashboard</p>
                    </a>
                </li>
                <li>
                    <a th:href="@{/logout}">
                        <i class="nc-icon nc-user-run"></i>
                        <p>Logout</p>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <!--  End side navbar  -->
    <div class="main-panel"> <!--  Day la phan ben phai cua trang  -->
        <!-- Top Navbar, SUA TIEU DE TRANG CHO PHU HOP -->
        <nav class="navbar navbar-expand-lg navbar-absolute fixed-top navbar-transparent">
            <div class="container-fluid">
                <span class="navbar-brand">VietLand Auction</span>
            </div>
        </nav>
        <!-- End Top Navbar -->
        <!-- Noi dung cua trang se nam trong phan content nay -->
        <div class="content">
            <div class="row">
                <div class="col-md-12">
                    <div class="card card-user">
                        <div class="card-header">
                            <h5 class="card-title">Customer care information</h5>
                        </div>
                        <!-- Account fields -->
                        <div class="card-body">
                            <!-- Account fields and avatar -->
                            <div class="card-body">
                                <div class="row">
                                    <!-- Avatar column -->
                                    <div class="col-md-4">
                                        <div th:object="${staffDTO}">
                                            <div style="justify-content: center; align-content: center; text-align: center">
                                                <form th:action="@{/customercare/uploadAvatar}" method="post" enctype="multipart/form-data">

                                                    <a href="#">
                                                        <img th:src="*{account.avatar_image.getPath()}" alt="Avatar Image" style="margin: 5px" class="img-fluid rounded-circle" width="300" height="300">
                                                    </a>
                                                    <!-- Input field to choose an avatar image -->
                                                    <input type="file"  name="avatar" id="avatar" class="form-control" accept="image/png, image/jpeg, image/jpg" required>

                                                    <!-- Submit button to upload the image -->
                                                    <button type="submit"  style="margin: 10px" class="btn btn-primary mt-3">Upload Avatar</button>
                                                </form>

                                            </div>
                                        </div>
                                    </div>
                                    <!-- Fields column -->
                                    <div class="col-md-8">
                                        <div class="row" th:object="${staffDTO}">
                                            <input type="hidden" class="form-control" th:field="*{account.accountId}" name="accountId" readonly >
                                            <div class="col-md-6 pr-1">
                                                <div class="form-group">
                                                    <label>Username</label>
                                                    <input type="text" class="form-control" th:field="*{account.username}" name="username" placeholder="Username" readonly >
                                                </div>
                                            </div>
                                            <div class="col-md-6 pl-1">
                                                <div class="form-group">
                                                    <label>Email address</label>
                                                    <input type="email" class="form-control" th:field="*{account.email}" name="email" placeholder="Email" readonly >
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Customer fields -->
                                        <div class="row" th:object="${staffDTO}">
                                            <input type="hidden" class="form-control" th:field="*{staffId}" name="staffId" readonly >
                                            <div class="col-md-6 pr-1">
                                                <div class="form-group">
                                                    <label>Gender</label>
                                                    <select class="form-control" th:field="*{gender}" name="gender" readonly >
                                                        <option value="M">Male</option>
                                                        <option value="F">Female</option>
                                                        <option value="O">Other</option>
                                                    </select>
                                                </div>
                                            </div>

                                            <div class="col-md-6 pl-1">
                                                <div class="form-group">
                                                    <label>Date of Birth</label>
                                                    <input type="date" class="form-control" th:field="*{staff.dateOfBirth}" name="dateOfBirth" readonly >
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Additional customer fields -->
                                        <div class="row" th:object="${staffDTO}">
                                            <div class="col-md-6 pr-1">
                                                <div class="form-group">
                                                    <label>Phone Number</label>
                                                    <input type="text" class="form-control" th:field="*{staff.phoneNumber}" name="phoneNumber" placeholder="Phone Number" readonly >
                                                </div>
                                            </div>
                                            <div class="col-md-6 pl-1">
                                                <div class="form-group">
                                                    <label>Full Name</label>
                                                    <input type="text" class="form-control" th:field="*{staff.fullName}" name="fullName" placeholder="Full Name" readonly >
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Address, etc. -->
                                        <div class="row" th:object="${staffDTO}">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label>Address</label>
                                                    <input type="text" class="form-control" th:field="*{staff.address}" name="address" placeholder="Home Address" readonly >
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Change Password Button -->
                                        <div class="col-md-12 text-center">
                                            <!-- Button to trigger Change Password modal -->
                                            <button type="button" class="btn btn-secondary btn-round" style="color: white" data-bs-toggle="modal" data-bs-target="#changePasswordModal">
                                                Change Password
                                            </button>
                                        </div>
                                    </div>
                                    <!-- End fields column -->



                                    <!-- Change Password Modal -->
                                    <div class="row modal fade" id="changePasswordModal" tabindex="-1" aria-labelledby="changePasswordModalLabel" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="changePasswordModalLabel">Change Password</h5>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                </div>
                                                <form id="changePasswordForm">
                                                    <div class="modal-body">
                                                        <!-- Old Password Field -->
                                                        <div class="mb-3">
                                                            <label for="oldPassword" class="form-label">Old Password:</label>
                                                            <input type="password" class="form-control" id="oldPassword" name="oldPassword" required>
                                                        </div>

                                                        <!-- New Password Field -->
                                                        <div class="mb-3">
                                                            <label for="newPassword" class="form-label">New Password:</label>
                                                            <input type="password" class="form-control" id="newPassword" name="newPassword" required>
                                                        </div>

                                                        <!-- Confirm Password Field -->
                                                        <div class="mb-3">
                                                            <label for="confirmPassword" class="form-label">Confirm New Password:</label>
                                                            <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" required>
                                                        </div>
                                                        <div id="passwordError" class="text-danger" style="display: none;"></div>
                                                        <div id="passwordSuccess" class="text-success" style="display: none;"></div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                        <button type="submit" class="btn btn-primary">Change Password</button>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>

                                    <script>
                                        document.getElementById('changePasswordForm').addEventListener('submit', function(event) {
                                            event.preventDefault();

                                            const form = event.target;
                                            const formData = new FormData(form);

                                            fetch('/profile/change-password', {
                                                method: 'POST',
                                                body: formData
                                            })
                                                .then(response => response.json())
                                                .then(data => {
                                                    const errorDisplay = document.getElementById("passwordError");
                                                    const successDisplay = document.getElementById("passwordSuccess");

                                                    if (data.status === 'success') {
                                                        successDisplay.style.display = 'block';
                                                        errorDisplay.style.display = 'none';
                                                        successDisplay.innerText = data.message;
                                                        form.reset();
                                                    } else {
                                                        successDisplay.style.display = 'none';
                                                        errorDisplay.style.display = 'block';
                                                        errorDisplay.innerText = data.message;
                                                    }
                                                })
                                                .catch(error => {
                                                    console.error('Error:', error);
                                                });
                                        });
                                    </script>
                                    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<!---------------------------------------KHONG DUOC SUA------------------------------------------------------>
<!--   Core JS Files   -->
<script th:src="@{/dashboardStatic/js/core/jquery.min.js}"></script>
<script th:src="@{/dashboardStatic/js/core/popper.min.js}"></script>
<script th:src="@{/dashboardStatic/js/core/bootstrap.min.js}"></script>
<script th:src="@{/dashboardStatic/js/plugins/perfect-scrollbar.jquery.min.js}"></script>
<!-- Chart JS -->
<script th:src="@{/dashboardStatic/js/plugins/chartjs.min.js}"></script>
<!--  Notifications Plugin    -->
<script th:src="@{/dashboardStatic/js/plugins/bootstrap-notify.js}"></script>
<!-- Control Center for Now Ui Dashboard: parallax effects, scripts for the example pages etc -->
<script th:src="@{/dashboardStatic/js/paper-dashboard.min.js?v=2.0.1}" type="text/javascript"></script>
<!-- Paper Dashboard DEMO methods, don't include it in your project! -->
<script th:src="@{/dashboardStatic/demo/demo.js}"></script>
<script>
    $(document).ready(function () {
        // Javascript method's body can be found in assets/assets-for-demo/js/demo.js
        demo.initChartsPages();
    });
</script>
</body>

</html>
